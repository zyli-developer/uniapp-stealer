"use strict";const e=require("../../common/vendor.js");Array||e.resolveComponent("uni-easyinput")();const _=()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js";Math||_();const x={__name:"index",setup(f){e.useStore();const i=e.ref();e.onLoad(()=>{i.value=e.wx$1.createInterstitialAd({adUnitId:"advertising"}),i.value&&i.value.show()}),e.onUnload(()=>{i.value.destory()});const s=e.ref(),n=e.ref(""),l=e.ref(!1),c=()=>{let o=n.value.trim();if(!o){e.wx$1.showToast({icon:"error",title:"请输入"});return}return o=o.replaceAll("#",""),o=o.replaceAll("&",""),new Promise((r,a)=>{l.value=!0,e.index.request({url:`https://justinli.love/video/info?url=${o}`,method:"GET",success:t=>{if(console.log("----------res------",t),!t.statusCode===200){a(t.data);return}s.value=t.data,console.log("info",s),r(t)},fail:t=>{console.error("------err------",t),a(t)},complete:()=>{l.value=!1}})})},p=e.ref(),d=e.ref(),w=()=>{l.value=!1,e.wx$1.showLoading({title:"下载中"}),e.index.request({url:"https://justinli.love/video/list",method:"GET",success:o=>{o.statusCode===200&&(p.value=o.data,d.value=o.data[0].value,h())},fail:o=>{l.value=!0,e.wx$1.hideLoading(),e.wx$1.showToast({icon:"error",title:"请重试"}),console.error("------err------",o)}})},h=()=>{let o=n.value.trim();if(!o){e.wx$1.showToast({icon:"error",title:"请输入"});return}o=o.replaceAll("#",""),o=o.replaceAll("&","");let r=e.wx$1.env.USER_DATA_PATH+"/"+new Date().valueOf()+".mp4";e.wx$1.downloadFile({url:"https://justinli.love/video/download?type="+d.value+"&url="+o,filePath:r,success(a){a.statusCode===200&&e.wx$1.saveVideoToPhotosAlbum({filePath:a.filePath,success(t){e.wx$1.hideLoading(),e.wx$1.showToast({icon:"success",title:"已保存到相册"})},fail(t){e.wx$1.hideLoading(),e.wx$1.showToast({icon:"error",title:"请重试"}),console.log("err",t)},complete:()=>{l.value=!0}})},fail:()=>{e.wx$1.hideLoading(),e.wx$1.showToast({icon:"error",title:"请重试"}),l.value=!0}})};return(o,r)=>{var a,t,v;return e.e({a:e.o(c),b:e.o(u=>n.value=u),c:e.p({suffixIcon:"search",placeholder:"请输入分享地址",modelValue:n.value}),d:e.o(u=>c()),e:l.value,f:e.o(u=>w()),g:l.value,h:(a=s.value)==null?void 0:a.cover},(t=s.value)!=null&&t.cover?{i:s.value.cover}:{},{j:e.t((v=s.value)==null?void 0:v.desc)})}}},m=e._export_sfc(x,[["__scopeId","data-v-4978fed5"],["__file","/Users/zyli/Desktop/frontend/HBuilderProject/life-tools/pages/home/index.vue"]]);wx.createPage(m);
